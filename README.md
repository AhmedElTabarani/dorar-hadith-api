# Dorar.net Hadith API

السلام عليكم ورحمة الله وبركاته

منذ مدة حاولت استعمال الـ `API` الخاص [بالدرر السنية](https://dorar.net/article/389/%D8%AE%D8%AF%D9%85%D8%A9-%D9%88%D8%A7%D8%AC%D9%87%D8%A9-%D8%A7%D9%84%D9%85%D9%88%D8%B3%D9%88%D8%B9%D8%A9-%D8%A7%D9%84%D8%AD%D8%AF%D9%8A%D8%AB%D9%8A%D8%A9-API)  
لكنني واجهت بعض الصعوبات منها أن الـ `API` يتعامل مع [JSONP](https://en.wikipedia.org/wiki/JSONP) فقط وأيضًا لن تستطيع التعامل معه بالطرق العادية بسبب الـ [CORS](https://en.wikipedia.org/wiki/Cross-origin_resource_sharing)

وإن نجحت بتجنب الـ `CORS` باستعمال `JSONP` فتحصل على الناتج بهيئة `HTML`
وأيضًا لا يوجد `documentation` أو مستند ما يشرح تفاصيل هذا الـ `API` وكيفية التعامل معه

فأنا قررت عمل `API` وسيط يتجنب مشكلة `CORS` ويعطيك البيانات كهيئة `JSON`
بجانب شرح مفصل للـ `API`

- الرابط: https://dorar-hadith-api.cyclic.app/
- يتم عمل `cache` لكل عملية بحث لمدة `5` ثواني

## Documentation

### Endpoints

يحتوي الـ `API` على **ثلاث** `endpoint`، وهي:

#### /api/search?value={text}

يستخدم الـ `API` الرسمي الخاص بالدرر السنية للبحث عن الأحاديث  
يعطي `15` نتيجة

شكل الرد كـ `JSON`

```
[
    {
        hadith: 'الحديث',
        el_rawi: 'الراوي',
        el_mohdith: 'المحدث',
        source: 'المصدر',
        number_or_page: 'رقم الحديث او الصفحة',
        grade: 'درجة الصحة',
    },
    {
        ...
    },
    ...
]
```

#### /site/search?value={text}

يستخدم صفحة البحث الخاصة بموقع الدرر السنية للبحث عن الأحاديث  
يعطي `30` نتيجة

شكل الرد كـ `JSON`

```
[
    {
        hadith: 'الحديث',
        el_rawi: 'الراوي',
        el_mohdith: 'المحدث',
        source: 'المصدر',
        number_or_page: 'رقم الحديث او الصفحة',
        grade: 'درجة الصحة',
        hasSharhMetadata: 'هل الحديث له شرح أم لا',
        sharhMetadata: {
            id: 'رقم الشرح',
            isCantainSharh: 'هل يحتوى هذا الرد على شرح الحديث أم لا؟',
            urlToGetSharh: 'رابط لكي تبحث عن شرح الحديث',
        },
    },
    {
        ...
    },
    ...
]
```

#### /site/sharh?value={text}

يستخدم صفحة البحث الخاصة بموقع الدرر السنية للبحث عن شرح للحديث  
يعطي `30` نتيجة

شكل الرد كـ `JSON`

```
[
    {
        hadith: 'الحديث',
        el_rawi: 'الراوي',
        el_mohdith: 'المحدث',
        source: 'المصدر',
        number_or_page: 'رقم الحديث او الصفحة',
        grade: 'درجة الصحة',
        hasSharhMetadata: 'هل الحديث له شرح أم لا',
        sharhMetadata: {
            id: 'رقم الشرح',
            isCantainSharh: 'هل يحتوى هذا الرد على شرح الحديث أم لا؟',
            sharh: 'شرح الحديث',
            urlToGetSharh: 'رابط لكي تبحث عن شرح الحديث',
        },
    },
    {
        ...
    },
    ...
]
```

#### /site/oneSharhBy?id={sharhId}

يستخدم صفحة البحث الخاصة بموقع الدرر السنية للبحث عن شرح للحديث  
يعطي نتيجة واحدة وهو الحديث صاحب الـ `id`

شكل الرد كـ `JSON`

```
{
    hadith: 'الحديث',
    el_rawi: 'الراوي',
    el_mohdith: 'المحدث',
    source: 'المصدر',
    number_or_page: 'رقم الحديث او الصفحة',
    grade: 'درجة الصحة',
    hasSharhMetadata: 'هل الحديث له شرح أم لا',
    sharhMetadata: {
        id: 'رقم الشرح',
        isCantainSharh: 'هل يحتوى هذا الرد على شرح الحديث أم لا؟',
        sharh: 'شرح الحديث',
        urlToGetSharh: 'رابط لكي تبحث عن شرح الحديث',
    },
},
```

#### /site/oneSharhBy?value={text}

يستخدم صفحة البحث الخاصة بموقع الدرر السنية للبحث عن شرح للحديث  
يعطي نتيجة واحدة وهو الحديث المطابق للنص

شكل الرد كـ `JSON`

```
{
    hadith: 'الحديث',
    el_rawi: 'الراوي',
    el_mohdith: 'المحدث',
    source: 'المصدر',
    number_or_page: 'رقم الحديث او الصفحة',
    grade: 'درجة الصحة',
    hasSharhMetadata: 'هل الحديث له شرح أم لا',
    sharhMetadata: {
        id: 'رقم الشرح',
        isCantainSharh: 'هل يحتوى هذا الرد على شرح الحديث أم لا؟',
        sharh: 'شرح الحديث',
        urlToGetSharh: 'رابط لكي تبحث عن شرح الحديث',
    },
},
```

### Query

عناصر الـ `query` التي يمكنك استخدامها

- `value` وهي محتوى نص الحديث المراد البحث عنه
- `page` لتحديد الصفحة التي تريدها  
  القيمة الافتراضية ستكون الصفحة رقم واحد `page=1`
- `removehtml` حذف عناصر الـ `HTML` في الحديث كـ
  `<span class="search-keys">...</span>`
  القيمة الافتراضي هي `true`
- `tab` تستخدم فقط في `/site/search` لتحدد نوع الاحاديث هل هي للمتخصصين أم لا  
  قيمها هي `specialist"` للمتخصصين و `home` لغير المتخصصين  
  القيمة الافتراضية هي `home`
- `xclude` كلمة أو جملة تريد استبعادها من البحث
  - مثال `/api/search?value=جملة البحث&xclude=اليهود` هكذا سيستبعد كلمة `اليهود` من البحث
- `st` تحدد طريقة البحث بثلاثة خيارات فقط سواء بـ `جميع الكلمات` أو بـ `أي كلمة`
  أو بـ `بحث مطابق`
- `t` تحديد نطاق البحث بمعنى هل تريد البحث عن `جميع الأحاديث` أم
  `الأحاديث المرفوعة` أم `الأحاديث القدسية` أم `آثار الصحابة` أم `شروح الأحاديث`
- `d[]` تحديد درجة الحديث سواء صحيح ام ضعيف
- `m[]` تحديد اسماء المحدثين التي تريدهم
- `s[]` تحديد الكتب التي تريد البحث فيها
- `rawi[]` تحديد اسماء الرواة التي تريدهم

- هذه الاقواس `[]` تفيد ان هذا العنصر يقبل اكثر من اختيار

#### st لتحديد طريقة البحث

- `st` تحدد طريقة البحث بثلاثة خيارات فقط
- هذه الطرق هي: `جميع الكلمات`، `أي كلمة`، `بحث مطابق`
- قيمها هي: `w`, `a`, `p`
  - للبحث بـ `جميع الكلمات` فستكون `st=w`
  - للبحث بـ `أي كلمة` فستكون `st=a`
  - للبحث بـ `بحث مطابق` فستكون `st=p`
- مثال `/api/search?value=جملة البحث&st=p` هكذا سيبحث بشكل مطابق لجملة البحث

[كل القيم وطرق البحث التي تمثلها](./data/method-search.txt)

#### t نطاق البحث

- `t` تحديد نطاق البحث
- هذه النطاقات هي: `جميع الأحاديث`، `الأحاديث المرفوعة`، `الأحاديث القدسية`، `آثار الصحابة`، `شروح الأحاديث`
- قيمها هي: `*`, `0`, `1`, `2`, `3`
  - للبحث عن `جميع الأحاديث` فستكون `t=*`
  - للبحث عن `الأحاديث المرفوعة` فستكون `t=0`
  - للبحث عن `الأحاديث القدسية` فستكون `t=1`
  - للبحث عن `آثار الصحابة` فستكون `t=2`
  - للبحث عن `شروح الأحاديث` فستكون `t=3`
- مثال `/api/search?value=جملة البحث&t=1` هكذا سيبحث فقط عن الأحاديث القدسية المطابق لجملة البحث

[كل القيم ونطاقات البحث التي تمثلها](./data/zone-search.txt)

#### d[] درجة الحديث

- `d[]` تحديد درجة الحديث سواء صحيح ام ضعيف
- قيمها هي: `0`، `1`، `2`، `3`، `4`
  - للبحث عن `جميع الدرجات` فستكون `d[]=0`
  - للبحث عن `أحاديث حكم المحدثون عليها بالصحة` فستكون `d[]=1`
  - للبحث عن `أحاديث حكم المحدثون على أسانيدها بالصحة` فستكون `d[]=2`
  - للبحث عن `أحاديث حكم المحدثون عليها بالضعف` فستكون `d[]=3`
  - للبحث عن `أحاديث حكم المحدثون على أسانيدها بالضعف` فستكون `d[]=4`
- مثال `/api/search?value=جملة البحث&d[]=3` هكذا سيبحث فقط عن الأحاديث المحكوم عليها بالضعف
- يمكنك تحديد اكثر من اختيار
  - مثال `/api/search?value=جملة البحث&d[]=1&d[]=2` هكذا سيبحث فقط عن الأحاديث المحكوم عليها بالصحة من ناحية المتن و الاسناد

[كل القيم والدرجات التي تمثلها](./data/degree.txt)

#### m[] اسماء المحدثين

- `m[]` تحديد اسماء المحدثين التي تريدهم
- قيمها متعددة ومنها: `0`، `179`، `204`، `256`، `261` ... إلخ
  - حيث `0` تمثل `جميع المحدثين`
  - و`179` تمثل `الإمام المالك`
  - و`204` تمثل `الإمام الشافعي`
  - و`256` تمثل `البخاري`
  - و`261` تمثل `مسلم`
- مثال `/api/search?value=جملة البحث&m[]=179` هكذا سيبحث فقط عن الأحاديث التي حدث بها الإمام مالك
- يمكنك تحديد اكثر من اختيار
  - مثال `/api/search?value=جملة البحث&m[]=256&m[]=261` هكذا سيبحث فقط عن الأحاديث التي حدثا بها بخاري ومسلم

[كل القيم وأسماء المحدثين التي تمثلها](./data/el_mohdith.txt)

#### s[] اسماء الكتب

- `s[]` تحديد الكتب التي تريد البحث فيها
- قيمها متعددة ومنها: `0`، `13457`، `6216`، `3088`، `96` ... إلخ
  - حيث `0` تمثل `جميع المحدثين`
  - و`13457` تمثل `الأربعون النووية`
  - و`6216` تمثل `صحيح البخاري`
  - و`3088` تمثل `صحيح مسلم`
  - و`96` تمثل `الصحيح المسند`
- مثال `/api/search?value=جملة البحث&s[]=96` هكذا سيبحث فقط عن الأحاديث الواردة في كتاب الصحيح المسند
- يمكنك تحديد اكثر من اختيار
  - مثال `/api/search?value=جملة البحث&s[]=6216&s[]=13457` هكذا سيبحث فقط عن الأحاديث التي وردت في كتابي الأربعون النووية وكتاب صحيح البخاري

[كل القيم وأسماء الكتب التي تمثلها](./data/book.txt)

#### rawi[] اسماء الرواة

- `rawi[]` تحديد اسماء الرواة التي تريدهم
- قيمها متعددة ومنها: `0`،`1819`، `8918`، `2664` ... إلخ
  - حيث `0` تمثل `جميع الرواة`
  - حيث `1819` تمثل `أسماء بنت أبي بكر`
  - و`8918` تمثل `عمر بن الخطاب`
  - و`2664` تمثل `ابن عباس`
- مثال `/api/search?value=جملة البحث&rawi[]=1819` هكذا سيبحث فقط عن الأحاديث التي رواتها أسماء بنت أبي بكر
- يمكنك تحديد اكثر من اختيار
  - مثال `/api/search?value=جملة البحث&rawi[]=8918&rawi[]=2664` هكذا سيبحث فقط عن الأحاديث التي رواها عمر بن الخطاب وابن عباس
- هنا قيم ترمز لأكثر من شخص في آن واحد
  - مثل `2665` ترمز لـ `ابن عباس أو أبو هريرة`
  - `8924` ترمز لـ `عمر بن الخطاب وأبو هريرة`
  - `264` ترمز لـ `أبو الدرداء وأبو أمامة وعبدالله بن عمر وابن عباس وجابر بن عبدالله`

[كل القيم وأسماء الرواة التي تمثلها](./data/el_rawi.txt)
